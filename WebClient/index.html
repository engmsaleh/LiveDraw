<!DOCTYPE html>
<html>
<head>
    <title>LiveDraw</title>
    <script src="http://js.pusher.com/1.12/pusher.min.js" type="text/javascript"></script>
    <script src="http://code.jquery.com/jquery.min.js" type="text/javascript"></script>
    <script src="https://raw.github.com/DmitryBaranovskiy/raphael/master/raphael-min.js"></script>
    <script type="text/javascript">

        $(document).ready(function () {
            // Enable pusher logging - don't include this in production
            Pusher.log = function (message) {
                if (window.console && window.console.log) window.console.log(message);
            };

            // Flash fallback logging - don't include this in production
            WEB_SOCKET_DEBUG = true;

            Pusher.channel_auth_endpoint = 'http://phillipcohen.net/LiveDraw/auth.php';
            Pusher.channel_auth_transport = 'jsonp';

            var paper = new Raphael(document.getElementById('canvas_container'), 900, 900);
            var pusher = new Pusher('e658d927568df2c3656f');
            var channel = pusher.subscribe('private-livedraw-1.2');
            channel.bind('client-batch', function (data) {
                $.each(data, function (index, event) {
                    if (event.event == "client-draw-line") {
//                    alert("Draw line from (" + event.start.x + "," + event.start.y + ")");
                        paper.path("M 250 250 l " + event.start.x + " " + event.start.y + " " + event.end.x + " " + event.end.y + "z");
                    }
                });
            });

        });
        function addDot(x, y) {
            var color = '#000000';
            var size = '1px';
            $("body").append(
                    $('<div></div>')
                            .css('position', 'absolute')
                            .css('top', x + 'px')
                            .css('left', y + 'px')
                            .css('width', size)
                            .css('height', size)
                            .css('background-color', color)
            );
        }
    </script>
</head>
<body>
<div id="canvas_container">

</div>
</body>
</html>