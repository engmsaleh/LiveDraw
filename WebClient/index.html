<!DOCTYPE html>
<html>
<head>
    <title>LiveDraw</title>
    <script src="http://js.pusher.com/1.12/pusher.min.js" type="text/javascript"></script>
    <script src="http://code.jquery.com/jquery.min.js" type="text/javascript"></script>
    <script src="/js/jcanvas.min.js" type="text/javascript"></script>
    <script type="text/javascript">

        $(document).ready(function () {
            // Enable pusher logging - don't include this in production
            Pusher.log = function (message) {
                if (window.console && window.console.log) window.console.log(message);
            };

            // Flash fallback logging - don't include this in production
            WEB_SOCKET_DEBUG = true;

            Pusher.channel_auth_endpoint = 'http://phillipcohen.net/LiveDraw/auth.php';
            Pusher.channel_auth_transport = 'jsonp';

            var pusher = new Pusher('e658d927568df2c3656f');
            var channel = pusher.subscribe('private-livedraw-1.2');
            channel.bind('client-batch', function (data) {
                $.each(data, function (index, event) {
                    if (event.event == "client-draw-line") {

                        $("canvas").drawLine({
                            x1:event.start.x, y1:event.start.y,
                            x2:event.end.x, y2:event.end.y,
                            strokeWidth:3,
                            strokeStyle:"#333",
                            rounded:true
                        });

                        $("canvas").drawLine({
                            strokeStyle:"#000",
                            strokeWidth:10,
                            x1:event.start.x, y1:event.start.y,
                            x2:event.end.x, y2:event.end.y
//                            x3: 200, y3: 100,
//                            x4: 150, y4: 200
                        });
                        console.log("Draw line from (" + event.start.x + "," + event.start.y + ") to (" + event.end.x + "," + event.end.y + ")");
//                        paper.path("M 250 250 l " + event.start.x + " " + event.start.y + " " + event.end.x + " " + event.end.y + "z");
                    }
                });
            });
        });
    </script>
</head>
<body>

<canvas id="mainCanvas" width="900" height="900">

</canvas>

</body>
</html>